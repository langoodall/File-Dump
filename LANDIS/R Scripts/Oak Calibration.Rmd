---
title: "Untitled"
output: pdf_document
date: "2024-06-12"
---


```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(terra)
library(sf)
library(rFIA)
library(latex2exp)
```



```{r}
# Read in IC map and ecoregions map
mapIC <- rast("C:/Users/lagoodal/Desktop/All Raster Layers/Clipped Piedmont/MapCode_IC.tif")
ecoregions <- rast("C:/Users/lagoodal/Desktop/All Raster Layers/Clipped Piedmont/ecoregions.tif")
# plot(mapIC)
# Get MapCodes
mapCodes <- read_csv("C:/Users/lagoodal/Desktop/TESTING FOR OAK GROWTH/Final_table.csv")


# This bit has gone through several iterations but I will leave in the multicell landscape 
# code examples rather than all of them

# Filter for QUAL and then perform logical tests to see which cells have only (or nearly only)
# the criteria that we are interested in OG = 365
mapCodes %>%
  filter(CohortAge %in% c(30) & SpeciesName == "QUAL")
mapCodes %>% filter(MapCode == 60)

cell_indices <- which(values(mapIC) == 60)
row_col_indices <- rowColFromCell(mapIC, cell_indices)
row_col_indices
values(ecoregions) <- 0
for (i in 1:nrow(row_col_indices)) {
  ecoregions[row_col_indices[,1][i], row_col_indices[,2][i]] <- 1
}


# QURU 4000 5987 6447
mapCodes %>%
  filter(CohortAge < 20 & SpeciesName == "QURU")
mapCodes %>% filter(MapCode == 6447)
cell_indices <- which(values(mapIC) == 6447)
row_col_indices <- rowColFromCell(mapIC, cell_indices)
row_col_indices
for (i in 1:nrow(row_col_indices)) {
  ecoregions[row_col_indices[,1][i], row_col_indices[,2][i]] <- 1
}

# QUPH
mapCodes %>%
  filter(CohortAge < 20 & SpeciesName == "QUPH")
mapCodes %>% filter(MapCode == 515)
cell_indices <- which(values(mapIC) == 515)
row_col_indices <- rowColFromCell(mapIC, cell_indices)
row_col_indices
for (i in 1:nrow(row_col_indices)) {
  ecoregions[row_col_indices[,1][i], row_col_indices[,2][i]] <- 1
}

# QUCO2
mapCodes %>%
  filter(CohortAge < 20 & SpeciesName == "QUCO2")
mapCodes %>% filter(MapCode == 1846)
cell_indices <- which(values(mapIC) == 1846)
row_col_indices <- rowColFromCell(mapIC, cell_indices)
row_col_indices
for (i in 1:nrow(row_col_indices)) {
  ecoregions[row_col_indices[,1][i], row_col_indices[,2][i]] <- 1
}

# QUFA
mapCodes %>%
  filter(CohortAge < 20 & SpeciesName == "QUFA")
mapCodes %>% filter(MapCode == 262)
cell_indices <- which(values(mapIC) == 262)
row_col_indices <- rowColFromCell(mapIC, cell_indices)
row_col_indices
for (i in 1:nrow(row_col_indices)) {
  ecoregions[row_col_indices[,1][i], row_col_indices[,2][i]] <- 1
}

# QUMO4
mapCodes %>%
  filter(CohortAge < 20 & SpeciesName == "QUMO4")
mapCodes %>% filter(MapCode == 340)
cell_indices <- which(values(mapIC) == 340)
row_col_indices <- rowColFromCell(mapIC, cell_indices)
row_col_indices
for (i in 1:nrow(row_col_indices)) {
  ecoregions[row_col_indices[,1][i], row_col_indices[,2][i]] <- 1
}

# QUST
mapCodes %>%
  filter(CohortAge < 20 & SpeciesName == "QUST")
mapCodes %>% filter(MapCode == 157)
cell_indices <- which(values(mapIC) == 157)
row_col_indices <- rowColFromCell(mapIC, cell_indices)
row_col_indices
for (i in 1:nrow(row_col_indices)) {
  ecoregions[row_col_indices[,1][i], row_col_indices[,2][i]] <- 1
}

# QUVE 5917
mapCodes %>%
  filter(CohortAge < 20 & SpeciesName == "QUVE")
mapCodes %>% filter(MapCode == 6662)
cell_indices <- which(values(mapIC) == 6662)
row_col_indices <- rowColFromCell(mapIC, cell_indices)
row_col_indices
for (i in 1:nrow(row_col_indices)) {
  ecoregions[row_col_indices[,1][i], row_col_indices[,2][i]] <- 1
}


plot(ecoregions)


ecoregions %>% as.data.frame() %>% filter(layer != 0)

writeRaster(ecoregions, "C:/Users/lagoodal/Desktop/TESTING FOR OAK GROWTH/Clipped Piedmont/ecoregions.tif", overwrite = TRUE, datatype = "INT2S")



###############################
# 1 CELL
# 
# values(ecoregions) <- 0
# ecoregions[391,87] <- 1
# writeRaster(ecoregions, "C:/Users/lagoodal/Desktop/TESTING FOR OAK GROWTH/Clipped Piedmont/ecoregions.tif", overwrite = TRUE, datatype = "INT2S")
```



```{r}
values(ecoregions) <- 0

ecoregions[447,340] <- 1
ecoregions[447,341] <- 1
ecoregions[447,342] <- 1
ecoregions[448,340] <- 1
ecoregions[448,341] <- 1
ecoregions[448,342] <- 1
ecoregions[449,340] <- 1
ecoregions[449,341] <- 1
ecoregions[449,342] <- 1
ecoregions[450,340] <- 1
ecoregions[450,341] <- 1
ecoregions[450,342] <- 1
ecoregions[451,340] <- 1
ecoregions[451,341] <- 1
ecoregions[451,342] <- 1
ecoregions[452,340] <- 1
ecoregions[452,341] <- 1
ecoregions[452,342] <- 1


plot(ecoregions)
plot(raster_list[[1]])


writeRaster(ecoregions, "C:/Users/lagoodal/Desktop/TESTING FOR OAK GROWTH/Clipped Piedmont/ecoregions.tif", overwrite = TRUE, datatype = "INT2S")


ecoregions[447,640] <- 1
ecoregions[447,641] <- 1
ecoregions[447,642] <- 1
ecoregions[448,640] <- 1
ecoregions[448,641] <- 1
ecoregions[448,642] <- 1
ecoregions[449,640] <- 1
ecoregions[449,641] <- 1
ecoregions[449,642] <- 1
ecoregions[450,640] <- 1
ecoregions[450,641] <- 1
ecoregions[450,642] <- 1
ecoregions[451,640] <- 1
ecoregions[451,641] <- 1
ecoregions[451,642] <- 1
ecoregions[452,640] <- 1
ecoregions[452,641] <- 1
ecoregions[452,642] <- 1

ecoregions[447,643] <- 1
ecoregions[447,644] <- 1
ecoregions[447,645] <- 1
ecoregions[448,643] <- 1
ecoregions[448,644] <- 1
ecoregions[448,645] <- 1
ecoregions[449,643] <- 1
ecoregions[449,644] <- 1
ecoregions[449,645] <- 1
ecoregions[450,643] <- 1
ecoregions[450,644] <- 1
ecoregions[450,645] <- 1
ecoregions[451,643] <- 1
ecoregions[451,644] <- 1
ecoregions[451,645] <- 1
ecoregions[452,643] <- 1
ecoregions[452,644] <- 1
ecoregions[452,645] <- 1



plot(ecoregions)
plot(raster_list[[1]])


writeRaster(ecoregions, "C:/Users/lagoodal/Desktop/TESTING FOR OAK GROWTH/Clipped Piedmont/ecoregions.tif", overwrite = TRUE, datatype = "INT2S")


values(ecoregions) <- 0

ecoregions[467,1000] <- 1
ecoregions[467,1001] <- 1
ecoregions[467,1002] <- 1
ecoregions[468,1000] <- 1
ecoregions[468,1001] <- 1
ecoregions[468,1002] <- 1
ecoregions[469,1000] <- 1
ecoregions[469,1001] <- 1
ecoregions[469,1002] <- 1
ecoregions[470,1000] <- 1
ecoregions[470,1001] <- 1
ecoregions[470,1002] <- 1
ecoregions[471,1000] <- 1
ecoregions[471,1001] <- 1
ecoregions[471,1002] <- 1
ecoregions[472,1000] <- 1
ecoregions[472,1001] <- 1
ecoregions[472,1002] <- 1



ecoregions[467,1003] <- 1
ecoregions[467,1004] <- 1
ecoregions[467,1005] <- 1
ecoregions[468,1003] <- 1
ecoregions[468,1004] <- 1
ecoregions[468,1005] <- 1
ecoregions[469,1003] <- 1
ecoregions[469,1004] <- 1
ecoregions[469,1005] <- 1
ecoregions[470,1003] <- 1
ecoregions[470,1004] <- 1
ecoregions[470,1005] <- 1
ecoregions[471,1003] <- 1
ecoregions[471,1004] <- 1
ecoregions[471,1005] <- 1
ecoregions[472,1003] <- 1
ecoregions[472,1004] <- 1
ecoregions[472,1005] <- 1


plot(ecoregions)
plot(raster_list[[1]])


writeRaster(ecoregions, "C:/Users/lagoodal/Desktop/TESTING FOR OAK GROWTH/Clipped Piedmont/ecoregions.tif", overwrite = TRUE, datatype = "INT2S")

```



```{r}
NC_FIA <- readFIA("C:/Users/lagoodal/Desktop/Dissertation Stuff/NC FIA")
# clippedPiedmont.shp <- st_read("C:/Users/lagoodal/Desktop/All Raster Layers/standsraster/Clipped Shapefile/clippedHUC.shp")
NC_FIA <- clipFIA(NC_FIA, mask = piedmontBoundary[1])

TREE <- NC_FIA$TREE
COND <- NC_FIA$COND

#Piedmont_coords <- read_csv("C:/Users/lagoodal/Desktop/Dissertation Stuff/Level 4 Piedmont Co-ordinates.csv")
#TREE <- NC_FIA$TREE %>% inner_join(Piedmont_coords, by = c("COUNTYCD", "PLOT"))
#COND <- NC_FIA$COND %>% inner_join(Piedmont_coords, by = c("COUNTYCD", "PLOT"))

TREE$COUNTYCD <- sprintf("%03s", TREE$COUNTYCD)
TREE$PLOT <- sprintf("%05s", TREE$PLOT)
TREE$SUBP <- sprintf("%03s", TREE$SUBP)
TREE$TREE <- sprintf("%03s", TREE$TREE)
TREE <- TREE %>%
  mutate(GEOID = paste0(COUNTYCD, PLOT),
         TREEID = paste0(COUNTYCD, PLOT, SUBP, TREE))

COND$COUNTYCD <- sprintf("%03s", COND$COUNTYCD)
COND$PLOT <- sprintf("%05s", COND$PLOT)
COND <- COND %>%
  mutate(GEOID = paste0(COUNTYCD, PLOT))


TREE <- TREE %>%
  filter(SPGRPCD < 50,
         INVYR %in% 2000:9000,
         SPCD %in% c(316,373,403,409,531,541,544,602,68,621,611,693,711,110,129,131,132,731,762,802,806,812,832,831,833,835,837,972,971)) %>%
  mutate(dummySPGRPCD = ifelse(SPGRPCD %in% 1:24, "Softwoods", "Hardwoods"))

TREE$dummySPGRPCD <- ifelse(TREE$SPCD == 802 | TREE$SPCD == 831 | TREE$SPCD == 833, "Mesic Oaks", TREE$dummySPGRPCD)
TREE$dummySPGRPCD <- ifelse(TREE$SPCD == 806 | TREE$SPCD == 812 | TREE$SPCD == 832 | TREE$SPCD == 835 | TREE$SPCD == 837, "Xeric Oaks", TREE$dummySPGRPCD)


treeTable <- full_join(TREE, COND, by = c("GEOID", "COUNTYCD", "PLT_CN", "INVYR", "STATECD", "UNITCD", "PLOT", "CONDID"))

treeTable <- treeTable %>%
  filter(INVYR < 9000,
         SPCD < 998)

treeTable <- treeTable[,c("GEOID", "TREEID", "CARBON_AG", "STDAGE", "INVYR", "SPCD", "dummySPGRPCD", "TPA_UNADJ")] %>%
  unique()

treeTable <- treeTable %>%
  mutate(BIOMASS = CARBON_AG * 2,
         BIOMASS_AC = BIOMASS * TPA_UNADJ,
         BIOMASS_gm2 = BIOMASS_AC * 0.1121)


treeTable <- treeTable %>%
  mutate(binnedAGE = ifelse(STDAGE %in% 1:10, 10,
                            ifelse(STDAGE %in% 11:20, 20,
                                   ifelse(STDAGE %in% 21:30, 30,
                                          ifelse(STDAGE %in% 31:40, 40,
                                                 ifelse(STDAGE %in% 41:50, 50,
                                                        ifelse(STDAGE %in% 51:60, 60,
                                                               ifelse(STDAGE %in% 61:70, 70,
                                                                      ifelse(STDAGE %in% 71:80, 80,
                                                                             ifelse(STDAGE %in% 81:90, 90,
                                                                                    ifelse(STDAGE %in% 91:100, 100,
                                                                                           ifelse(STDAGE %in% 101:110, 110,
                                                                                                  ifelse(STDAGE %in% 111:120, 120,
                                                                                                         ifelse(STDAGE %in% 121:130, 130,
                                                                                                                ifelse(STDAGE %in% 131:140, 140,
                                                                                                                       ifelse(STDAGE %in% 141:150, 150, 160))))))))))))))))

treeTable <- treeTable %>%
  group_by(binnedAGE, dummySPGRPCD) %>%
  filter(quantile(BIOMASS_gm2, 0.75, na.rm = T) < BIOMASS_gm2,
         binnedAGE < 101)

```



```{r}
calibrateLOG <- data.table::fread("C:/Users/lagoodal/Desktop/TESTING FOR OAK GROWTH/NECN-calibrate-log.csv")

# calibrateLOG %>%
#   filter(Year == 10,
#          Month == 1) %>%
#   group_by(SpeciesName) %>%
#   summarise(avgAGE = round(mean(CohortAge)),
#             medianAGE = round(median(CohortAge)))

calibrateLOG %>%
  group_by(Year) %>%
  summarise(LAI = mean(ActualLAI)) %>%
  ggplot(., aes(x = Year, y = LAI)) +
  geom_line() +
  theme_classic()
```

	Parameterization of a Poisson Density Function curve to simulate temperature effect on growth. P = index for parameter:
1 = Optimum temperature for production - the peak of the curve.
2 = Maximum temperature for production; larger values = broader bell shape, and production is less sensitive to soil temperature.
3 = Spread of the bell curve; smaller values = broader bell shape, and production is less sensitive to soil temperature.
4 = Left curve shape; smaller values = more production at lower temperatures.

KLAI
Large wood mass (g C m-2) at which half of the theoretical maximum leaf area ( MAXLAI) is achieved.

# Xeric Oaks
# 1 Cell Landscape

```{r}
ggplot(treeTable %>% filter(dummySPGRPCD %in% c("Mesic Oaks", "Xeric Oaks")), aes(x = as.factor(binnedAGE), y = BIOMASS_gm2)) +
  geom_boxplot() +
  geom_point(alpha = 0) +
  geom_smooth(method = "loess", aes(group = 1)) +
  theme_classic() +
  ylim(0,5100) +
  facet_wrap(~dummySPGRPCD) +
  xlab("Stand Age") +
  ylab(TeX("AGB $(\\g/m^2)$")) +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 14, dummySPGRPCD = "Xeric Oaks"), col = "red") + # QUST
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 593, dummySPGRPCD = "Xeric Oaks"), col = "red") + # 0.58 r2
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 1011, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1278, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1630, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1558, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1606, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1476, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1523, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1406, dummySPGRPCD = "Xeric Oaks"), col = "red")



ggplot(treeTable %>% filter(dummySPGRPCD %in% c("Mesic Oaks", "Xeric Oaks")), aes(x = as.factor(binnedAGE), y = BIOMASS_gm2)) +
  geom_boxplot() +
  geom_point(alpha = 0) +
  geom_smooth(method = "loess", aes(group = 1)) +
  theme_classic() +
  ylim(0,5100) +
  facet_wrap(~dummySPGRPCD) +
  xlab("Stand Age") +
  ylab(TeX("AGB $(\\g/m^2)$")) +
  #geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 14, dummySPGRPCD = "Xeric Oaks"), col = "red") + # QUCO2
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 116, dummySPGRPCD = "Xeric Oaks"), col = "red") + 
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 700, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1077, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 841, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1417, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 833, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1079, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 700, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 969, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  #geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 14, dummySPGRPCD = "Xeric Oaks"), col = "blue") + # QUFA
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 73, dummySPGRPCD = "Xeric Oaks"), col = "blue") + 
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 595, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 920, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1222, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1610, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1709, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1684, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1679, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1641, dummySPGRPCD = "Xeric Oaks"), col = "blue")


ggplot(treeTable %>% filter(dummySPGRPCD %in% c("Mesic Oaks", "Xeric Oaks")), aes(x = as.factor(binnedAGE), y = BIOMASS_gm2)) +
  geom_boxplot() +
  geom_point(alpha = 0) +
  geom_smooth(method = "loess", aes(group = 1)) +
  theme_classic() +
  ylim(0,5100) +
  facet_wrap(~dummySPGRPCD) +
  xlab("Stand Age") +
  ylab(TeX("AGB $(\\g/m^2)$")) +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 14, dummySPGRPCD = "Xeric Oaks"), col = "red") + # QUCO2
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 593, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 1011, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1278, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1630, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1558, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1606, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1476, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1523, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1406, dummySPGRPCD = "Xeric Oaks"), col = "red")


simulated <- c(14,73,
595, 
920, 
1222,
1610,
1709,
1684,
1679,
 1641)
treeTable %>%
  filter(dummySPGRPCD == "Xeric Oaks") %>%
  group_by(binnedAGE) %>%
  summarise(median = median(BIOMASS_gm2)) %>%
  cbind(., simulated) %>%
  lm(simulated ~ median, data = .) %>%
  summary(.)



```

# 3 Cell Run

```{r}
ggplot(treeTable %>% filter(dummySPGRPCD %in% c("Mesic Oaks", "Xeric Oaks")), aes(x = as.factor(binnedAGE), y = BIOMASS_gm2)) +
  geom_boxplot() +
  geom_point(alpha = 0) +
  geom_smooth(method = "loess", aes(group = 1)) +
  theme_classic() +
  ylim(0,5100) +
  facet_wrap(~dummySPGRPCD) +
  xlab("Stand Age") +
  ylab(TeX("AGB $(\\g/m^2)$")) +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 35, dummySPGRPCD = "Xeric Oaks"), col = "red") + # QUST
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 540, dummySPGRPCD = "Xeric Oaks"), col = "red") + # 0.56 r2
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 831, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1066, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1429, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1390, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1327, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1257, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1234, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1197, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 31, dummySPGRPCD = "Xeric Oaks"), col = "blue") + # QUFA 
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 638, dummySPGRPCD = "Xeric Oaks"), col = "blue") + # 0.59 r2
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 971, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1265, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1744, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1673, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1593, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1561, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1511, dummySPGRPCD = "Xeric Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1491, dummySPGRPCD = "Xeric Oaks"), col = "blue")





treeTable %>%
  filter(dummySPGRPCD == "Xeric Oaks") %>%
  group_by(binnedAGE) %>%
  summarise(median = median(BIOMASS_gm2))


median <- c(233,464,512,765,1021,1343,1579,1523,1773,1874)
simulated <- c(35,
540, 
831, 
1066,
1429,
1390,
1327,
1257,
1234,
 1197)
data <- as.data.frame(cbind(median, simulated))
summary(lm(simulated ~ median, data = data))
```

# Mesic Oaks
# 1 Cell Landscape

```{r}
ggplot(treeTable %>% filter(dummySPGRPCD %in% c("Mesic Oaks", "Xeric Oaks")), aes(x = as.factor(binnedAGE), y = BIOMASS_gm2)) +
  geom_boxplot() +
  geom_point(alpha = 0) +
  geom_smooth(method = "loess", aes(group = 1)) +
  theme_classic() +
  ylim(0,5100) +
  facet_wrap(~dummySPGRPCD) +
  xlab("Stand Age") +
  ylab(TeX("AGB $(\\g/m^2)$")) +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 14, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") + # QUAL
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 593, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 1011, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1278, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1630, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1558, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1606, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1476, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1523, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1406, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen")




ggplot(treeTable %>% filter(dummySPGRPCD %in% c("Mesic Oaks", "Xeric Oaks")), aes(x = as.factor(binnedAGE), y = BIOMASS_gm2)) +
  geom_boxplot() +
  geom_point(alpha = 0) +
  geom_smooth(method = "loess", aes(group = 1)) +
  theme_classic() +
  ylim(0,5100) +
  facet_wrap(~dummySPGRPCD) +
  xlab("Stand Age") +
  ylab(TeX("AGB $(\\g/m^2)$")) +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 3, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") + # QUAL
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 266, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") + # 0.83
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 579, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 805, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 974, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 983, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1173, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  #geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1476, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  #geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1523, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  #geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1406, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 7, dummySPGRPCD = "Mesic Oaks"), col = "blue") + # QURU
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 474, dummySPGRPCD = "Mesic Oaks"), col = "blue") + # 0.62 r2
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 914, dummySPGRPCD = "Mesic Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1274, dummySPGRPCD = "Mesic Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1551, dummySPGRPCD = "Mesic Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1861, dummySPGRPCD = "Mesic Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1993, dummySPGRPCD = "Mesic Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 2206, dummySPGRPCD = "Mesic Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1457, dummySPGRPCD = "Mesic Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1503, dummySPGRPCD = "Mesic Oaks"), col = "blue") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 16, dummySPGRPCD = "Xeric Oaks"), col = "red") + # QUST
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 381, dummySPGRPCD = "Xeric Oaks"), col = "red") + # 0.58
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 670, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 997, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1390, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1439, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1499, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1153, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1185, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1148, dummySPGRPCD = "Xeric Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 4, dummySPGRPCD = "Xeric Oaks"), col = "orange") + # QUFA 
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 245, dummySPGRPCD = "Xeric Oaks"), col = "orange") + # 0.87
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 397, dummySPGRPCD = "Xeric Oaks"), col = "orange") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 572, dummySPGRPCD = "Xeric Oaks"), col = "orange") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 795, dummySPGRPCD = "Xeric Oaks"), col = "orange") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 857, dummySPGRPCD = "Xeric Oaks"), col = "orange") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 901, dummySPGRPCD = "Xeric Oaks"), col = "orange") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 902, dummySPGRPCD = "Xeric Oaks"), col = "orange") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 933, dummySPGRPCD = "Xeric Oaks"), col = "orange") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 922, dummySPGRPCD = "Xeric Oaks"), col = "orange")

treeTable %>%
  filter(dummySPGRPCD == "Xeric Oaks") %>%
  group_by(binnedAGE) %>%
  summarise(median = median(BIOMASS_gm2))


median <- c(233,464,512,765,1021,1343,1579)
simulated <- c(3,
266,
579,
805,
974,
983,
1173)
data <- as.data.frame(cbind(median, simulated))
summary(lm(simulated ~ median, data = data))

```


# Oak Landscape (255 cells)

```{r}

ggplot(treeTable %>% filter(dummySPGRPCD %in% c("Mesic Oaks", "Xeric Oaks", "Hardwoods")), aes(x = as.factor(binnedAGE), y = BIOMASS_gm2)) +
  geom_boxplot() +
  geom_point(alpha = 0) +
  geom_smooth(method = "loess", aes(group = 1)) +
  theme_classic() +
  ylim(0,5100) +
  facet_wrap(~dummySPGRPCD) +
  xlab("Stand Age") +
  ylab(TeX("AGB $(\\g/m^2)$")) +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 1, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") + # QUAL
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 77, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 162, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 219, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 272, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 307, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 333, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 351, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 362, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 370, dummySPGRPCD = "Mesic Oaks"), col = "forestgreen") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 4, dummySPGRPCD = "Mesic Oaks"), col = "red") + # QURU
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 564, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 1098, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1489, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1848, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 2107, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 2288, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 2407, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 2485, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 2536, dummySPGRPCD = "Mesic Oaks"), col = "red") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 1, dummySPGRPCD = "Mesic Oaks"), col = "violet") + # QUPH
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 132, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 252, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 332, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 401, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 446, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 477, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 496, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 508, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 514, dummySPGRPCD = "Mesic Oaks"), col = "violet") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 6, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") + # QUCO2
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 756, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 1487, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1975, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 2403, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 2728, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 2950, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 3094, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 3187, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 3247, dummySPGRPCD = "Xeric Oaks"), col = "firebrick") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 1, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") + # QUFA
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 167, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 329, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 439, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 535, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 599, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 642, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 669, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 685, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 693, dummySPGRPCD = "Xeric Oaks"), col = "mediumorchid") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 1, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") + # QUMO4
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 137, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 268, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 357, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 434, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 483, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 516, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 537, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 550, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 558, dummySPGRPCD = "Xeric Oaks"), col = "olivedrab") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 1, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") + # QUST
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 67, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 145, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 199, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 247, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 276, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 296, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 308, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 315, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 319, dummySPGRPCD = "Xeric Oaks"), col = "turquoise") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 11, dummySPGRPCD = "Xeric Oaks"), col = "navy") + # QUVE
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 272, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 480, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 619, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 743, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 840, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 910, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 954, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 980, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 =996, dummySPGRPCD = "Xeric Oaks"), col = "navy") +
  geom_point(data = data.frame(binnedAGE = 10, BIOMASS_gm2 = 4, dummySPGRPCD = "Hardwoods"), col = "gold") + # QUVE
  geom_point(data = data.frame(binnedAGE = 20, BIOMASS_gm2 = 363, dummySPGRPCD = "Hardwoods"), col = "gold") +
  geom_point(data = data.frame(binnedAGE = 30, BIOMASS_gm2 = 736, dummySPGRPCD = "Hardwoods"), col = "gold") +
  geom_point(data = data.frame(binnedAGE = 40, BIOMASS_gm2 = 1021, dummySPGRPCD = "Hardwoods"), col = "gold") +
  geom_point(data = data.frame(binnedAGE = 50, BIOMASS_gm2 = 1303, dummySPGRPCD = "Hardwoods"), col = "gold") +
  geom_point(data = data.frame(binnedAGE = 60, BIOMASS_gm2 = 1520, dummySPGRPCD = "Hardwoods"), col = "gold") +
  geom_point(data = data.frame(binnedAGE = 70, BIOMASS_gm2 = 1697, dummySPGRPCD = "Hardwoods"), col = "gold") +
  geom_point(data = data.frame(binnedAGE = 80, BIOMASS_gm2 = 1825, dummySPGRPCD = "Hardwoods"), col = "gold") +
  geom_point(data = data.frame(binnedAGE = 90, BIOMASS_gm2 = 1919, dummySPGRPCD = "Hardwoods"), col = "gold") +
  geom_point(data = data.frame(binnedAGE = 100, BIOMASS_gm2 = 1987, dummySPGRPCD = "Hardwoods"), col = "gold")

```






```{r}

totalLobMetricTons <- 788000000 * 0.015422

perHecMetricTons <- totalLobMetricTons / (17969160 * 0.404686)

```







```{r}
library(terra)

# Define the directory containing the .img files and the directory to save the .tif files
input_dir <- "C:/Users/lagoodal/Desktop/FAKE"
output_dir <- "C:/Users/lagoodal/Desktop/FAKE"

# List all .img files in the input directory
img_files <- list.files(input_dir, pattern = "\\.img$", full.names = TRUE)

# Loop to read in .img files
for (img_file in img_files) {
  # Read the .img file
  raster <- rast(img_file)
  
  # Create the output file path with the same base name but .tif extension
  output_file <- file.path(output_dir, paste0(tools::file_path_sans_ext(basename(img_file)), ".tif"))
  
  # Write the raster to a .tif file
  writeRaster(raster, output_file)
}

```





